---
- name: Update and upgrade systems
  hosts: all
  become: yes
  tasks:
    - name: Update apt cache
      become: yes
      apt:
        update_cache: yes

    - name: Upgrade all packages
      become: yes
      apt:
        upgrade: dist
        autoremove: yes
        autoclean: yes

    - name: Notify Discord that system update was successful
      uri:
        url: "https://discord.com/api/webhooks/1367967683617886208/0uatkPCBQrjrIvGErc6l0lNXhoysLOfR7Kwcf7shEL80s0dyvZvTDcOHUO8jYrzh9hA6"
        method: POST
        headers:
          Content-Type: "application/json"
        body_format: json
        body: >
          {
            "content": "âœ… System update completed successfully on **{{ inventory_hostname }}**"
          }
        status_code:
          - 200
          - 204
